{
  "resources": [
    {
      "type": "pubsub.v1.topic",
      "name": "pipeline01-job-topic",
      "properties": {
        "topic": "pipeline01-job-topic"
      }
    },
    {
      "type": "pubsub.v1.subscription",
      "name": "pipeline01-job-subscription",
      "properties": {
        "subscription": "pipeline01-job-subscription",
        "topic": "$(ref.pipeline01-job-topic.name)",
        "ackDeadlineSeconds": 600
      }
    },
    {
      "type": "pubsub.v1.topic",
      "name": "pipeline01-progress-topic",
      "properties": {
        "topic": "pipeline01-progress-topic"
      }
    },
    {
      "type": "pubsub.v1.subscription",
      "name": "pipeline01-progress-subscription",
      "properties": {
        "subscription": "pipeline01-progress-subscription",
        "topic": "$(ref.pipeline01-progress-topic.name)",
        "ackDeadlineSeconds": 30
      }
    },
    {
      "name": "pipeline01-it",
      "type": "compute.v1.instanceTemplate",
      "properties": {
        "zone": "us-central1-f",
        "properties": {
          "machineType": "f1-micro",
          "networkInterfaces": [
            {
              "network": "https://www.googleapis.com/compute/v1/projects/dummy-proj-999/global/networks/default",
              "accessConfigs": [
                {
                  "name": "External-IP",
                  "type": "ONE_TO_ONE_NAT"
                }
              ]
            }
          ],
          "disks": [
            {
              "deviceName": "boot",
              "type": "PERSISTENT",
              "boot": true,
              "autoDelete": true,
              "initializeParams": {
                "sourceImage": "https://www.googleapis.com/compute/v1/projects/google-containers/global/images/gci-stable-55-8872-76-0"
              }
            }
          ],
					"scheduling": {
						"preemptible": false
					},
          "serviceAccounts": [
            {
              "scopes": [
                "https://www.googleapis.com/auth/devstorage.full_control",
                "https://www.googleapis.com/auth/pubsub",
                "https://www.googleapis.com/auth/logging.write",
                "https://www.googleapis.com/auth/monitoring.write",
                "https://www.googleapis.com/auth/cloud-platform"
              ]
            }
          ],
          "metadata": {
            "items": [
              {
                "key": "startup-script",
                "value": ""
              }
            ]
          }
        }
      }
    },
    {
      "name": "pipeline01-igm",
      "type": "compute.v1.instanceGroupManagers",
      "properties": {
        "baseInstanceName": "pipeline01-instance",
        "instanceTemplate": "$(ref.pipeline01-it.selfLink)",
        "targetSize": 2,
        "zone": "us-central1-f"
      }
    }
  ]
}
